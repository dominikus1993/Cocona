using Cocona.Application;
using Microsoft.Extensions.DependencyInjection;

namespace Cocona.Hosting;

public sealed class CoconaServiceProviderScopeSupport : ICoconaServiceProviderScopeSupport
{
    public (IDisposable Scope, IServiceProvider ScopedServiceProvider) CreateScope(IServiceProvider serviceProvider)
    {
        var scope = serviceProvider.CreateScope();
        return (scope, scope.ServiceProvider);
    }
    
    public (IAsyncDisposable Scope, IServiceProvider ScopedServiceProvider) CreateAsyncScope(IServiceProvider serviceProvider)
    {
        var scope = serviceProvider.CreateAsyncScope();
        return (scope, scope.ServiceProvider);
    }
}
